config indent_with_tabs false
lsp-start "zls"

map normal <space>b @": build @buffer-path()<enter>"
map normal <space>zo :<space>-find-zig-file<enter>
map normal <space>zf :<space>-find-zig-pattern<enter>

command build @{
    open scratch "build.log"
    enqueue-keys aad
    replace-with-output "cmd /c zig build < @arg(0)"
}
command -find-zig-file @{
    picker-entries-from-lines "fd -tf --path-separator / . @env(HOME)/scoop/apps/zig/current/lib/std"
    pick "zig open:" @{
        open history-disabled saving-disabled "@picker-entry()"
    }
}
command -find-zig-pattern @{
    readline "zig find:" @{
        open scratch "@readline-input().zig.refs"
        enqueue-keys aad
        replace-with-output 'rg --no-ignore-global --path-separator / --line-number "@readline-input()" @env(HOME)/scoop/apps/zig/current/lib/std'
    }
}

